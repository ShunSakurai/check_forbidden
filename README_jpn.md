# check_forbidden
このコードは、memoQのバイリンガルファイル(.mqxlz/.mqxliff)の訳文中に禁止されている訳語が使用されていないか確認するためのものです。

## 説明
memoQでは、禁止されている原語と訳語のペアを検証することはできますが、**禁止されている訳語のみを**、対応する原語に関係なく検証することはできません。これがきっかけで、このツールを開発しました。

このツールは、例えば次のような状況で使用できます。

- スタイルガイドにより、訳文中に「doesn't」や「can't」のような短縮系を使用できない場合
- 「US$1,000」という表記はできるが、「US 1,000 ドル」という表記はできない場合
- JP (日本語):「次の/次に」は使用できるが、「以下の/以下に」は使用できない場合
- JP:「例えば」を漢字にする必要があり、「たとえば」は使用できない場合

必要なものは次のとおりです。

- memoQのバイリンガルファイル(.mqxlzまたは.mqxliff形式)
- 禁止語の一覧を含むCSVファイルまたはテキストファイル

バイリンガルファイル中の禁止語を検索し、コマンドプロンプトに結果を表示し、さらに検索結果をCSVファイルにエクスポートします。

このツールは、Pythonとtkinterを使用してコーディングし、[py2exe](http://www.py2exe.org/)を使用して.exe形式で配布するものです。

## インストール
現在、Windowsにのみ対応しています。
インストーラーは現在開発中です。しばらくの間は、次を実行してください。

- 「dist」フォルダー全体をダウンロードします(すべてのファイルをzip形式でダウンロードして、そのフォルダーを選択します)
- フォルダー名を「check_forbidden」など、お好みの名前に変更します。
- フォルダーをC:\Program Filesに移動します
- .exeファイルへのショートカットを作成し、それをデスクトップ、ツール用フォルダー、C:\ProgramData\Microsoft\Windows\Start Menu\Programsなどに追加します

このプログラムは、動作するために **フォルダーに含めたまま** にしておく必要があります。プログラム単体では動作しません。

## 使用方法

### 概要
プログラムを開くには、check_forbidden.exeをダブルクリックします。

- 「Bilingual」(バイリンガル)をクリックするか、ファイルへのパスを入力または貼り付けることで、バイリンガルファイルを選択します
- 禁止語の一覧を含むCSVファイルまたはテキストファイルを選択します
- エクスポートする結果ファイルのパスとファイル名を選択します。既定値は、1つ目のバイリンガルファイルのパス + result.csvです
- 「Run!」(実行)をクリックします

![]()

- 結果はコマンドプロンプトに表示され、一致する結果が見つかった場合は、CSVファイルにもエクスポートされます
- プログラムを閉じるには、「Enter」キーを押すか、「X」(閉じる)ボタンをクリックします
- プログラムを開いたまま、何度も繰り返し実行できます
- 結果ファイルとして既存のCSVファイルを選択した場合、結果はファイルの末尾に追加されます

![]()

### memoQファイルの種類
次の2種類のファイルに対応しています。

- .mqxliff
- .mqxlz。これは、document.mqxliffファイルと、スケルトン(書式情報)を圧縮したファイルです。本プログラムでは、document.mqxliffをフォルダーに展開し、処理の終了後に削除しています

### CSVファイルの形式
各項目は、コンマで区切り、次のいずれかの形式にしてください。

- 禁止語の1列
- 禁止語と、追加情報(例: 正しい語)の2列
- **1列目** の用語が禁止語とみなされます

または

- 3列以上 (例: 通し番号、原語、訳語(禁止)、訳語(正))
- **3列目** の用語が禁止語とみなされます

![]()

### 単語の切れ目は考慮されません
本プログラムでは、各セグメントを単なる文字列として扱います。各単語は区別しません。

- 「play」は「playing」とも「display」とも一致します

### 大文字と小文字は区別されます
本プログラムでは、大文字と小文字は区別されます。CSVファイルに用語を追加する際には、大文字と小文字の両方を入力してください。

### 誤検出に注意
誤検出を防ぐための工夫を次に示します。
空白文字を追加します。

- 「display」との一致を防ぐには、CSVに「 play」(半角スペース + play)を追加します

漢字1文字の語など、短すぎる用語を使用しないようにします。

- JP:「等級」との一致を防ぐには、「等」(など)を追加しないようにします

## 履歴

文頭の「*」は、バグ修正を示します。

### ver.1.0.10、2016年3月28日
- 言語ペアを英->日からより一般的な原語->訳語に変更
- * バイリンガルファイルの解析時に正規表現を使用するため、バイリンガルファイルの選択肢から.txt形式を削除
- Readme.mdを作成

### ver.1.0.9、2016年3月24日
- * 禁止語が見つからない場合にフォルダーが削除されない問題を解決

### ver.1.0.8、2016年3月24日
- GitHubに追加

### ver.1.0.8、2016年3月22日
### ver.0.9.0、2016年3月17日
- 社内で使用開始

### 2015年12月8日
- [Pythonの入門書](http://www.amazon.co.jp/dp/4797371595)を購入

### 2015年7月30日
- 発案

## 今後追加予定の機能
### 開発中の機能

- コードの[リーダブル](http://www.amazon.co.jp/dp/4873115655)化
- インストーラーを用意
- アイコンを用意
- 画面の大きさの自由変更
- ファイルをドラッグで追加
- キーボードショートカット
- より使いやすい「ファイルを開く」ダイアログ

### 棚上げ中の機能

- バイリンガルファイル欄の{波かっこ}を非表示
- 禁止語の列を指定するための設定
- CSVの区切り文字を指定する設定
- エクスポート方法(コマンドプロンプト/CSVファイル)を選択するためのラジオボタン
- memoQ以外のファイルへの対応
- 禁止語一覧での正規表現の対応

すぐに使用した機能がある場合はご連絡ください。

## 貢献
これは個人的なプロジェクトにすぎず、どのようなコントリビュートをいただけるのかわかりません。どんなご意見や貢献も歓迎いたします。

## 使用権限
このツールは無料でお使いいただけます。

© 2016 Shun Sakurai
